<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,height=device-height, initial-scale=1">
        <link  id="favicon" href="slike/logo2.png" rel="shortcut icon" type="image/x-icon"  />
		<title>PREGLED REZERVACIJA</title>
		<link rel="stylesheet" type="text/css" href="stilovi.css" />
	</head>
	<body>
		<header>
			<div class='sitelogo'>
				<span class='sitename'><a href ='index.html'>PU<img src='slike/logo2.png' alt='logo2' id='logo2'>OVANJA</a></span>
			</div>
			<ul>
				<li><a href ='index.html' >početak</a></li>
				<li><a href ='destinacije.html' >destinacije</a></li>
				<li><a href ='rezervacije.html' >pregled rezervacija</a></li>
				<li><a href ='kontakt.html' >kontakt</a></li>
			</ul>
		</header>
		<section id='glavniR'>
			<table class='rezervacije th_under'> 
				<tr> 
				   <th>ime i prezime</th><th>destinacija</th><th>broj osoba</th><th>polazak</th><th>e-mail</th><th class="thBrisanje">brisanje</th> 
				</tr> 
			  </table> 
		</section>
		<footer></footer>
	</body>
	<script>

        var ls_putnik;
        
            if (localStorage.getItem('putnik') == null){
                ls_putnik = [];
            } else {
                ls_putnik = JSON.parse(localStorage.getItem('putnik'));
            } 
            var tabela = document.querySelector('.rezervacije');  
            for (var i = 0; i < ls_putnik.length; i++){
                var novi_red = document.createElement('tr');
                novi_red.innerHTML = '<td>' + ls_putnik[i].ime + '</td><td>' + ls_putnik[i].destinacija + '</td><td>' + ls_putnik[i].broj +
                                    '</td><td>' + ls_putnik[i].datum + '</td><td>' + ls_putnik[i].mail + '</td><td>' + '<a href="#" class="obrisi">Obriši</a>' + '</td>';
                tabela.appendChild(novi_red);
            }

            // odasvde počinje deo za brisanje rezervacija

            var zaBrisanje = document.querySelectorAll('.obrisi');
            for (var i = 0; i < zaBrisanje.length; i++){
                zaBrisanje[i].addEventListener('click', function(e){
                    obrisi(e.target.parentElement.parentElement.firstChild.textContent); // prosleđuje tekst prvog deteta TR elementa (koje sadrži ime) funkciji obrisi
                    e.target.parentElement.parentElement.remove(); // targetira roditelja roditelja kliknutog elementa, u ovom slučaju TR element i remove ga briše sa strane
                });
            }
            // briše stavku iz LS
            function obrisi(rezevacija){
                var ind = -1;
                for (var i = 0; i < ls_putnik.length; i++){
                    if (ls_putnik[i].ime == rezevacija){
                        ind = i;
                    }
                }
                ls_putnik.splice(ind, 1);
                localStorage.setItem('putnik', JSON.stringify(ls_putnik));
            }

    </script>
</html>
